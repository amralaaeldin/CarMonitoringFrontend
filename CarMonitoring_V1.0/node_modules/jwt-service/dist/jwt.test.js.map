{"version":3,"sources":["../src/jwt.test.ts"],"names":["describe","log","jest","fn","time","afterEach","mockReset","test","JWT","duration","tolerance","algorithms","YError","err","expect","errorCode","code","errorParams","params","logs","mock","calls","times","toMatchSnapshot","ENV","JWT_SECRET","mockReturnValueOnce","Date","getTime","jwt","token","sign","userId","organisationId","secret","decoded","verify"],"mappings":"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","sourcesContent":["// @ts-ignore: no type atm  ¯\\_(ツ)_/¯\nimport YError from 'yerror';\nimport initJWTService from './jwt';\n\ndescribe('jwt service', () => {\n  const log = jest.fn();\n  const time = jest.fn();\n\n  afterEach(() => {\n    log.mockReset();\n    time.mockReset();\n  });\n\n  describe('initializer', () => {\n    test('should fail without secret', async () => {\n      try {\n        await initJWTService({\n          JWT: {\n            duration: '2d',\n            tolerance: '2h',\n            algorithms: ['HS256'],\n          },\n          log,\n          time,\n        });\n        throw new YError('E_UNEXPECTED_SUCCESS');\n      } catch (err) {\n        expect({\n          errorCode: err.code,\n          errorParams: err.params,\n          logs: log.mock.calls,\n          times: time.mock.calls,\n        }).toMatchSnapshot();\n      }\n    });\n\n    test('should fail without algorithms', async () => {\n      try {\n        await initJWTService({\n          ENV: {\n            JWT_SECRET: 'test',\n          },\n          JWT: {\n            duration: '2d',\n            tolerance: '2h',\n            algorithms: [],\n          },\n          log,\n          time,\n        });\n        throw new YError('E_UNEXPECTED_SUCCESS');\n      } catch (err) {\n        expect({\n          errorCode: err.code,\n          errorParams: err.params,\n          logs: log.mock.calls,\n          times: time.mock.calls,\n        }).toMatchSnapshot();\n      }\n    });\n\n    test('should fail without duration', async () => {\n      try {\n        await initJWTService({\n          ENV: {\n            JWT_SECRET: 'test',\n          },\n          // @ts-ignore: no type atm ¯\\_(ツ)_/¯\n          JWT: {\n            tolerance: '2h',\n            algorithms: ['HS256'],\n          },\n          log,\n          time,\n        });\n        throw new YError('E_UNEXPECTED_SUCCESS');\n      } catch (err) {\n        expect({\n          errorCode: err.code,\n          errorParams: err.params,\n          logs: log.mock.calls,\n          times: time.mock.calls,\n        }).toMatchSnapshot();\n      }\n    });\n\n    test('should fail with a bad tolerance', async () => {\n      try {\n        await initJWTService({\n          ENV: {\n            JWT_SECRET: 'test',\n          },\n          JWT: {\n            duration: '2h',\n            tolerance: '',\n            algorithms: ['HS256'],\n          },\n          log,\n          time,\n        });\n        throw new YError('E_UNEXPECTED_SUCCESS');\n      } catch (err) {\n        expect({\n          errorCode: err.code,\n          errorParams: err.params,\n          logs: log.mock.calls,\n          times: time.mock.calls,\n        }).toMatchSnapshot();\n      }\n    });\n\n    test('should fail with a uninterpreted duration', async () => {\n      try {\n        await initJWTService({\n          ENV: {\n            JWT_SECRET: 'test',\n          },\n          JWT: {\n            duration: 'q',\n            algorithms: ['HS256'],\n          },\n          log,\n          time,\n        });\n        throw new YError('E_UNEXPECTED_SUCCESS');\n      } catch (err) {\n        expect({\n          errorCode: err.code,\n          errorParams: err.params,\n          logs: log.mock.calls,\n          times: time.mock.calls,\n        }).toMatchSnapshot();\n      }\n    });\n\n    test('should fallback to default tolerance', async () => {\n      await initJWTService({\n        ENV: {\n          JWT_SECRET: 'test',\n        },\n        JWT: {\n          duration: '2h',\n          algorithms: ['HS256'],\n        },\n        log,\n        time,\n      });\n    });\n  });\n\n  describe('sign', () => {\n    test('should work', async () => {\n      time.mockReturnValueOnce(new Date('2014-01-26T00:00:00Z').getTime());\n\n      const jwt = await initJWTService({\n        ENV: {\n          JWT_SECRET: 'secret',\n        },\n        JWT: {\n          duration: '2d',\n          tolerance: '2h',\n          algorithms: ['HS256'],\n        },\n        log,\n        time,\n      });\n      const token = await jwt.sign({\n        userId: 2,\n        organisationId: 3,\n      });\n\n      expect({\n        token,\n        logs: log.mock.calls,\n        times: time.mock.calls,\n      }).toMatchSnapshot();\n    });\n\n    test('should fail with a bad algorithm', async () => {\n      time.mockReturnValueOnce(new Date('2014-01-26T00:00:00Z').getTime());\n\n      const jwt = await initJWTService({\n        JWT: {\n          secret: 'secret',\n          duration: '2d',\n          tolerance: '2h',\n          algorithms: ['HS256'],\n        },\n        log,\n        time,\n      });\n\n      try {\n        await jwt.sign(\n          {\n            userId: 2,\n            organisationId: 3,\n          },\n          'LOLALG',\n        );\n        throw new YError('E_UNEXPECTED_SUCCESS');\n      } catch (err) {\n        expect({\n          errorCode: err.code,\n          errorParams: err.params,\n          logs: log.mock.calls,\n          times: time.mock.calls,\n        }).toMatchSnapshot();\n      }\n    });\n  });\n\n  describe('verify', () => {\n    test('should work', async () => {\n      time.mockReturnValueOnce(new Date('2014-01-26T00:00:00Z').getTime());\n\n      const jwt = await initJWTService({\n        JWT: {\n          secret: 'secret',\n          duration: '2d',\n          tolerance: '2h',\n          algorithms: ['HS256'],\n        },\n        log,\n        time,\n      });\n      const decoded = await jwt.verify(\n        'eyJhbGciOiJIUzI1NiJ9.' +\n          'eyJ1c2VySWQiOjIsIm9yZ2FuaXNhdGlvbklkIjozLCJpY' +\n          'XQiOjEzOTA2OTQ0MDAsImV4cCI6MTM5MDg2NzIwMCwibmJmIjoxMzkwNjk0NDAwfQ.' +\n          'DdWhIErffR-N-bTSsjr2tDOyinbMtYkL24IZxOVaB_0',\n      );\n\n      expect({\n        decoded,\n        logs: log.mock.calls,\n        times: time.mock.calls,\n      }).toMatchSnapshot();\n    });\n\n    test('should fail after the validity duration', async () => {\n      time.mockReturnValueOnce(new Date('2014-03-30T00:00:00Z').getTime());\n\n      const jwt = await initJWTService({\n        JWT: {\n          secret: 'secret',\n          duration: '2d',\n          tolerance: '2h',\n          algorithms: ['HS256'],\n        },\n        log,\n        time,\n      });\n\n      try {\n        await jwt.verify(\n          'eyJhbGciOiJIUzI1NiJ9.' +\n            'eyJ1c2VySWQiOjIsIm9yZ2FuaXNhdGlvbklkIjozLCJpY' +\n            'XQiOjEzOTA2OTQ0MDAsImV4cCI6MTM5MDg2NzIwMCwibmJmIjoxMzkwNjk0NDAwfQ.' +\n            'DdWhIErffR-N-bTSsjr2tDOyinbMtYkL24IZxOVaB_0',\n        );\n        throw new YError('E_UNEXPECTED_SUCCESS');\n      } catch (err) {\n        expect({\n          errorCode: err.code,\n          errorParams: err.params,\n          logs: log.mock.calls,\n          times: time.mock.calls,\n        }).toMatchSnapshot();\n      }\n    });\n\n    test('should fail with a malformed token', async () => {\n      time.mockReturnValueOnce(new Date('2014-03-30T00:00:00Z').getTime());\n\n      const jwt = await initJWTService({\n        JWT: {\n          secret: 'secret',\n          duration: '2d',\n          tolerance: '2h',\n          algorithms: ['HS256'],\n        },\n        log,\n        time,\n      });\n\n      try {\n        await jwt.verify('kikooolol');\n        throw new YError('E_UNEXPECTED_SUCCESS');\n      } catch (err) {\n        expect({\n          errorCode: err.code,\n          errorParams: err.params,\n          logs: log.mock.calls,\n          times: time.mock.calls,\n        }).toMatchSnapshot();\n      }\n    });\n  });\n});\n"],"file":"jwt.test.js"}